<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wiki Manager</title>
</head>
<body>
<script>
    (function() {
      const originalOpen = window.open;
      
      window.open = function(url, name, specs) {
        // 1. Log the EXACT URL being opened so we can see it
        console.log("[Auto-Patcher] CMS is trying to open:", url);
        
        // 2. Hunt for 'scope=repo' in ANY url (GitHub, Vercel, or Netlify)
        if (typeof url === "string" && (url.includes("scope=repo") || url.includes("scope%3Drepo"))) {
            console.log("[Auto-Patcher] CAUGHT IT: Found private scope.");
            
            // 3. Replace it with public_repo
            // The Regex handles both scope=repo and scope%3Drepo (encoded)
            url = url.replace(/scope(=|%3D)repo/g, "scope$1public_repo");
            
            console.log("[Auto-Patcher] SUCCESS: Patched URL to:", url);
        }
        
        return originalOpen.apply(window, arguments);
      };
    })();
  </script>
  <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
</body>
</html>
